Charge
<br><br><br><br>
<div id="space_description">Studio B, 7-9pm on March 7, 2014</div>
<br><br>
<input type="hidden" id="space_total" value="100">
<br><br>
<button id="book_it">Custom Purchase Example</button>

<script>
  var handler = StripeCheckout.configure({
    //key: 'pk_test_XYAoxUJ6VE4GGzZr7hQujucR', //Our publishable api key
    key: '<%= @publishable_key %>',
    //image: '/square-image.png',
    token: function(token, args) {
      console.log(token.id);
      data = { token_key: token.id, 
               amount: $('#space_total').val(), 
               description: $('#space_description').text()
             };

      $.post( '/payments/charge', data, function(response) {
        alert( 'success' );
        console.log(response);
      })
        .done(function() {
          alert( 'second success' );
        })
        .fail(function() {
          alert( 'error' );
        })
        .always(function() {
          alert( 'finished' );
      });
       
      // window.location = "/payments/process?token_id=" + token.id;
      // Use the token to create the charge with a server-side script.
      // You can access the token ID with `token.id`
    }
  });
  
  $('#book_it').on('click', function(e) {
    handler.open({
      name: 'Artspace',
      description: $('#space_description').text(),
      email: '<%= @email %>',
      amount: $('#space_total').val()
    });
    e.preventDefault();
  });
</script>
